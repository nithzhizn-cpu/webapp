<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SpySignal WebApp</title>
<style>
*{box-sizing:border-box}
body{margin:0;background:#05060a;color:#f5f5f5;font-family:system-ui,-apple-system,Segoe UI,sans-serif;}
.app{display:flex;height:100vh;width:100vw;overflow:hidden;}
.sidebar{width:30%;min-width:260px;background:#0b0d13;border-right:1px solid #181b22;display:flex;flex-direction:column;}
.profile{padding:16px;border-bottom:1px solid #181b22;}
.profile-title{display:flex;justify-content:space-between;align-items:center;}
.badge{font-size:11px;background:#1a243a;padding:4px 8px;border-radius:999px;color:#8cdcff;}
.sub{font-size:11px;color:#82889a;}
.search{padding:12px;border-bottom:1px solid #181b22;}
.search input{width:100%;padding:8px 10px;border-radius:10px;border:1px solid #262a35;background:#05060a;color:#fff;font-size:13px;}
.pin-row{display:flex;justify-content:space-between;align-items:center;font-size:12px;padding:0 4px;margin-top:8px;color:#afb4c6;}
.pin-row button{background:#1a243a;border:none;border-radius:999px;padding:4px 10px;color:#8cdcff;font-size:11px;cursor:pointer;}
.chat-list{flex:1;overflow-y:auto;}
.chat-item{padding:10px 12px;border-bottom:1px solid #11131a;cursor:pointer;transition:background .15s;font-size:13px;}
.chat-item:hover{background:#141823;}
.chat-item.active{background:#1a2030;}
.chat-item .top{display:flex;justify-content:space-between;align-items:center;}
.chat-item .name{font-weight:600;}
.chat-item .id{font-size:10px;color:#636a7f;font-family:monospace;}
.chat-item .meta{display:flex;justify-content:space-between;font-size:11px;margin-top:2px;color:#7c8296;}
.content{flex:1;display:flex;flex-direction:column;background:#05060a;}
.chat-header{padding:12px 14px;border-bottom:1px solid #181b22;display:flex;justify-content:space-between;align-items:center;}
.chat-header .left .name{font-size:15px;font-weight:600;}
.chat-header .left .sub{font-size:11px;color:#81879c;}
.chat-header .right{display:flex;gap:6px;}
.icon-btn{border:none;background:#101321;width:32px;height:32px;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#f5f5f5;font-size:16px;cursor:pointer;}
.icon-btn:hover{background:#1c2234;}
.messages{flex:1;padding:14px 14px 6px;overflow-y:auto;}
.msg{max-width:72%;padding:8px 10px;margin-bottom:8px;border-radius:14px;font-size:13px;background:#141823;}
.msg.mine{margin-left:auto;background:#3b45ff;}
.msg .meta{margin-top:2px;font-size:10px;opacity:.7;display:flex;justify-content:space-between;}
.msg.ttl{border:1px dashed #ffbe5b;}
.system{text-align:center;font-size:11px;color:#747a8b;margin:10px 0;}
.input-area{padding:10px;border-top:1px solid #181b22;background:#05060a;}
.row1{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;font-size:11px;color:#8b92a8;}
.row1 span.ttl-toggle{cursor:pointer;}
.row1 input[type="number"]{width:60px;padding:2px 6px;border-radius:8px;border:1px solid #262a35;background:#05060a;color:#fff;font-size:11px;}
.row2{display:flex;gap:6px;align-items:center;}
.row2 input[type="text"]{flex:1;padding:9px 10px;border-radius:12px;border:1px solid #262a35;background:#05060a;color:#fff;font-size:13px;}
.row2 button.send{padding:9px 14px;border-radius:12px;border:none;background:#3b45ff;color:#fff;font-size:13px;cursor:pointer;}
.attach-btn{border:none;background:#101321;width:32px;height:32px;border-radius:10px;display:flex;align-items:center;justify-content:center;cursor:pointer;}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:999;}
.modal-content{background:#0b0d13;border:1px solid #22283a;border-radius:16px;padding:18px;width:90%;max-width:420px;}
.modal-content h3{margin-top:0;margin-bottom:8px;font-size:16px;}
.modal-content p{margin-top:4px;font-size:13px;color:#9ba1b5;}
.modal-actions{margin-top:14px;display:flex;justify-content:flex-end;gap:8px;}
.modal-actions button{border:none;border-radius:10px;padding:6px 12px;font-size:13px;cursor:pointer;}
.btn-secondary{background:#141823;color:#e1e4f0;}
.btn-primary{background:#3b45ff;color:#fff;}
#qrCanvas{width:220px;height:220px;margin-top:8px;border-radius:8px;background:#05060a;}
</style>
</head>
<body>
<div class="app">
  <div class="sidebar">
    <div class="profile">
      <div class="profile-title">
        <div>
          <div style="font-weight:600;font-size:16px;">SpySignal</div>
          <div class="sub">WebApp —É Telegram ‚Ä¢ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —á–∞—Ç</div>
        </div>
        <span class="badge">E2EE</span>
      </div>
      <div class="sub" style="margin-top:6px;">
        –í–∞—à ID: <span id="myId" style="font-family:monospace;">...</span>
      </div>
    </div>
    <div class="search">
      <input id="searchInput" placeholder="–ü–æ—à—É–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ ID –∞–±–æ –Ω—ñ–∫–Ω–µ–π–º–æ–º‚Ä¶" />
      <div class="pin-row">
        <span>PIN / –ø—Ä–∏—Ö–æ–≤–∞–Ω—ñ —á–∞—Ç–∏</span>
        <button onclick="openPinModal()">–ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏</button>
      </div>
    </div>
    <div class="chat-list" id="chatList"></div>
  </div>

  <div class="content">
    <div class="chat-header">
      <div class="left">
        <div class="name" id="chatName">–ù–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —á–∞—Ç—É</div>
        <div class="sub" id="chatSub">–û–±–µ—Ä—ñ—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç –∑–ª—ñ–≤–∞, —â–æ–± –ø–æ—á–∞—Ç–∏ —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è</div>
      </div>
      <div class="right">
        <button class="icon-btn" onclick="startVoiceRecord()">üé§</button>
        <button class="icon-btn" onclick="startVideoRecord()">üé•</button>
        <button class="icon-btn" onclick="startCall()">üìû</button>
        <button class="icon-btn" onclick="openQrModal()">üîë</button>
      </div>
    </div>
    <div class="messages" id="messages"></div>
    <div class="input-area">
      <div class="row1">
        <span class="ttl-toggle" onclick="toggleTTL()">TTL: <span id="ttlLabel">–≤–∏–º–∫–Ω–µ–Ω–æ</span></span>
        <div>
          <span style="margin-right:4px;">—Å–µ–∫</span>
          <input type="number" id="ttlSeconds" value="30" min="5" />
        </div>
      </div>
      <div class="row2">
        <button class="attach-btn" onclick="attachFile()">üìé</button>
        <input id="msgInput" type="text" placeholder="–ù–∞–ø–∏—à—ñ—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è‚Ä¶" />
        <button class="send" onclick="sendMsg()">‚û§</button>
      </div>
    </div>
  </div>
</div>

<div class="modal" id="pinModal">
  <div class="modal-content">
    <h3>PIN —Ç–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω—ñ —á–∞—Ç–∏</h3>
    <p>PIN –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Ä–æ–∑–±–ª–æ–∫—É–≤–∞–Ω–Ω—è –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —á–∞—Ç—ñ–≤. –ú–æ–∂–Ω–∞ –∑–∞–¥–∞—Ç–∏ —Ç–∞–∫–æ–∂ —Ñ–µ–π–∫–æ–≤–∏–π PIN.</p>
    <label style="font-size:13px;">–û—Å–Ω–æ–≤–Ω–∏–π PIN:</label>
    <input id="mainPin" type="password" style="width:100%;padding:6px 8px;border-radius:8px;border:1px solid #262a35;background:#05060a;color:#fff;margin-bottom:6px;">
    <label style="font-size:13px;">–§–µ–π–∫–æ–≤–∏–π PIN:</label>
    <input id="fakePin" type="password" style="width:100%;padding:6px 8px;border-radius:8px;border:1px solid #262a35;background:#05060a;color:#fff;">
    <div class="modal-actions">
      <button class="btn-secondary" onclick="closePinModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
      <button class="btn-primary" onclick="savePins()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
    </div>
  </div>
</div>

<div class="modal" id="qrModal">
  <div class="modal-content">
    <h3>–í–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∫–ª—é—á–∞ —á–∞—Ç—É</h3>
    <p>–ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ QR-–∫–æ–¥ –∑ —ñ–Ω—à–∏–º –ø—Ä–∏—Å—Ç—Ä–æ—î–º. –Ø–∫—â–æ –∑–±—ñ–≥–∞—î—Ç—å—Å—è ‚Äî –∫–∞–Ω–∞–ª –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ.</p>
    <canvas id="qrCanvas"></canvas>
    <div class="modal-actions">
      <button class="btn-secondary" onclick="closeQrModal()">–ó–∞–∫—Ä–∏—Ç–∏</button>
    </div>
  </div>
</div>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<script>
const API_BASE = "https://rachele-nonaccredited-unvociferously.ngrok-free.dev"; // ‚Üê –ó–∞–º—ñ–Ω–∏ –Ω–∞ —Å–≤—ñ–π –±–µ–∫–µ–Ω–¥ (https://...)
let authToken = null;
let currentUser = null;
let activeChat = null;
let ttlEnabled = false;
let pins = { main:null, fake:null };
let hiddenUnlocked = true;

const tg = window.Telegram && window.Telegram.WebApp ? window.Telegram.WebApp : null;
if(tg){
  tg.expand();
}

/* ===== AES-GCM ===== */
async function sha256(str){
  const enc = new TextEncoder();
  const data = enc.encode(str);
  const hash = await crypto.subtle.digest("SHA-256", data);
  return new Uint8Array(hash);
}
async function deriveChatKey(myId, peerId){
  const ordered = [myId, peerId].sort().join(":");
  const keyBytes = await sha256(ordered);
  return crypto.subtle.importKey("raw", keyBytes, {name:"AES-GCM"}, false, ["encrypt","decrypt"]);
}
function bufToBase64(buf){
  return btoa(String.fromCharCode(...new Uint8Array(buf)));
}
function base64ToBuf(b64){
  const bin = atob(b64);
  const bytes = new Uint8Array(bin.length);
  for(let i=0;i<bin.length;i++) bytes[i]=bin.charCodeAt(i);
  return bytes.buffer;
}
async function encryptMessage(plaintext,myId,peerId){
  const key = await deriveChatKey(myId,peerId);
  const iv = crypto.getRandomValues(new Uint8Array(12));
  const ciphertext = await crypto.subtle.encrypt(
    {name:"AES-GCM", iv},
    key,
    new TextEncoder().encode(plaintext)
  );
  return { iv:bufToBase64(iv), ciphertext:bufToBase64(ciphertext) };
}
async function decryptMessage(iv,ciphertext,myId,peerId){
  try{
    const key = await deriveChatKey(myId,peerId);
    const plainBuf = await crypto.subtle.decrypt(
      {name:"AES-GCM", iv:new Uint8Array(base64ToBuf(iv))},
      key,
      base64ToBuf(ciphertext)
    );
    return new TextDecoder().decode(plainBuf);
  }catch(e){
    console.error("Decrypt error",e);
    return "‚ùó –ù–µ –≤–¥–∞–ª–æ—Å—è —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏";
  }
}

/* ===== API ===== */
async function apiGET(url){
  const headers = {};
  if(authToken) headers["Authorization"] = "Bearer "+authToken;
  const res = await fetch(API_BASE+url,{headers});
  if(!res.ok) throw new Error("HTTP "+res.status);
  return await res.json();
}
async function apiPOST(url,body){
  const headers = {"Content-Type":"application/json"};
  if(authToken) headers["Authorization"] = "Bearer "+authToken;
  const res = await fetch(API_BASE+url,{
    method:"POST",
    headers,
    body:JSON.stringify(body)
  });
  if(!res.ok) throw new Error("HTTP "+res.status);
  return await res.json();
}

/* ===== AUTH —á–µ—Ä–µ–∑ Telegram initData ===== */
async function registerUser(username){
  const resp = await fetch(API_BASE+"/api/register",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ username })
  });
  if(!resp.ok){
    alert("–ü–æ–º–∏–ª–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –Ω–∞ –±–µ–∫–µ–Ω–¥—ñ");
    throw new Error("Register error");
  }
  const data = await resp.json();
  return data;
}

async function initAuth(){
  let tgUser = null;
  if(tg && tg.initDataUnsafe && tg.initDataUnsafe.user){
    tgUser = tg.initDataUnsafe.user;
  }

  const savedStr = localStorage.getItem("spysignal_auth");
  if(savedStr){
    const saved = JSON.parse(savedStr);
    if(tgUser && saved.telegram_id && saved.telegram_id === tgUser.id){
      authToken = saved.token;
      currentUser = { id:saved.id, username:saved.username };
      document.getElementById("myId").textContent = currentUser.id;
      return;
    }
  }

  // –Ø–∫—â–æ –º–∏ —Ç—É—Ç ‚Äî –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –Ω–æ–≤–æ–≥–æ/—ñ–Ω—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  let username = "Anon"+Math.floor(Math.random()*9999);
  if(tgUser){
    if(tgUser.username) username = tgUser.username;
    else username = (tgUser.first_name || "User")+"_"+tgUser.id;
  }

  const data = await registerUser(username);
  authToken = data.token;
  currentUser = { id:data.id, username:data.username };
  document.getElementById("myId").textContent = currentUser.id;

  localStorage.setItem("spysignal_auth", JSON.stringify({
    id:data.id,
    username:data.username,
    token:data.token,
    telegram_id: tgUser ? tgUser.id : null
  }));
}

/* ===== UI / CHAT ===== */
function addSystem(text){
  const msgs = document.getElementById("messages");
  const div = document.createElement("div");
  div.className = "system";
  div.textContent = text;
  msgs.appendChild(div);
}
function addMsg(text,mine,ttlSec){
  const msgs = document.getElementById("messages");
  const div = document.createElement("div");
  div.className = "msg"+(mine?" mine":"")+(ttlSec?" ttl":"");
  const now = new Date();
  const metaLeft = ttlSec ? ("TTL "+ttlSec+"s") : "üîí AES-GCM";
  div.innerHTML = '<div class="body">'+text+'</div>'+
    '<div class="meta"><span>'+metaLeft+'</span><span>'+now.toLocaleTimeString()+'</span></div>';
  msgs.appendChild(div);
  msgs.scrollTop = msgs.scrollHeight;
  if(ttlSec){
    setTimeout(()=>div.remove(), ttlSec*1000);
  }
}

async function searchUsers(){
  const q = document.getElementById("searchInput").value.trim();
  if(!q) return;
  try{
    const res = await apiGET("/api/users/search?query="+encodeURIComponent(q));
    const list = document.getElementById("chatList");
    list.innerHTML = "";
    res.results.forEach(u=>{
      const item = document.createElement("div");
      item.className = "chat-item"+(activeChat && activeChat.id===u.id ? " active": "");
      item.innerHTML = '<div class="top"><div class="name">'+u.username+'</div></div>'+
        '<div class="meta"><span class="id">'+u.id+'</span><span></span></div>';
      item.onclick = ()=>openChat(u);
      list.appendChild(item);
    });
  }catch(e){
    console.error(e);
    addSystem("–ü–æ–º–∏–ª–∫–∞ –ø–æ—à—É–∫—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤");
  }
}

async function openChat(user){
  activeChat = user;
  document.getElementById("chatName").textContent = user.username;
  document.getElementById("chatSub").textContent = "ID: "+user.id+" ‚Ä¢ AES-GCM";
  const msgsEl = document.getElementById("messages");
  msgsEl.innerHTML = "";
  addSystem("–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó‚Ä¶");
  try{
    const res = await apiGET("/api/messages?peer_id="+encodeURIComponent(user.id));
    msgsEl.innerHTML = "";
    for(const m of res.messages){
      const plain = await decryptMessage(m.iv, m.ciphertext, currentUser.id, user.id);
      addMsg(plain, m.from_id===currentUser.id, m.ttl_sec);
    }
  }catch(e){
    console.error(e);
    addSystem("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é.");
  }
}

function toggleTTL(){
  ttlEnabled = !ttlEnabled;
  document.getElementById("ttlLabel").textContent = ttlEnabled ? "—É–≤—ñ–º–∫–Ω–µ–Ω–æ" : "–≤–∏–º–∫–Ω–µ–Ω–æ";
}

async function sendMsg(){
  if(!activeChat){
    alert("–û–±–µ—Ä—ñ—Ç—å —á–∞—Ç –∑–ª—ñ–≤–∞");
    return;
  }
  const input = document.getElementById("msgInput");
  const txt = input.value.trim();
  if(!txt) return;
  const ttlSec = ttlEnabled ? parseInt(document.getElementById("ttlSeconds").value || "30", 10) : null;
  try{
    const enc = await encryptMessage(txt, currentUser.id, activeChat.id);
    const body = {
      to: activeChat.id,
      iv: enc.iv,
      ciphertext: enc.ciphertext,
      msg_type: "text",
      ttl_sec: ttlSec
    };
    await apiPOST("/api/messages", body);
    addMsg(txt, true, ttlSec);
    input.value = "";
  }catch(e){
    console.error(e);
    alert("–ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏");
  }
}

function attachFile(){
  alert("–£ —Ü—ñ–π –¥–µ–º–æ-–≤–µ—Ä—Å—ñ—ó —Ñ–∞–π–ª–∏ –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è. –á—Ö –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ —á–µ—Ä–µ–∑ AES-GCM —Ç–∞ /api/messages –∑ msg_type='file'.");
}

/* –ì–æ–ª–æ—Å / –≤—ñ–¥–µ–æ (–ª–æ–∫–∞–ª—å–Ω–æ, –±–µ–∑ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –Ω–∞ –±–µ–∫–µ–Ω–¥) */
let recorder; let chunks=[];
async function startVoiceRecord(){
  if(!activeChat){ alert("–û–±–µ—Ä—ñ—Ç—å —á–∞—Ç"); return; }
  const stream = await navigator.mediaDevices.getUserMedia({audio:true});
  recorder = new MediaRecorder(stream);
  chunks=[];
  recorder.ondataavailable = e=>chunks.push(e.data);
  recorder.onstop = ()=>{
    const blob = new Blob(chunks,{type:"audio/webm"});
    const url = URL.createObjectURL(blob);
    addMsg('<audio controls src="'+url+'"></audio>', true, null);
  };
  recorder.start();
  alert("üé§ –ó–∞–ø–∏—Å. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –û–ö, —â–æ–± –∑—É–ø–∏–Ω–∏—Ç–∏.");
  recorder.stop();
}
async function startVideoRecord(){
  if(!activeChat){ alert("–û–±–µ—Ä—ñ—Ç—å —á–∞—Ç"); return; }
  const stream = await navigator.mediaDevices.getUserMedia({video:true,audio:true});
  recorder = new MediaRecorder(stream);
  chunks=[];
  recorder.ondataavailable = e=>chunks.push(e.data);
  recorder.onstop = ()=>{
    const blob = new Blob(chunks,{type:"video/webm"});
    const url = URL.createObjectURL(blob);
    addMsg('<video controls width="200" src="'+url+'"></video>', true, null);
  };
  recorder.start();
  alert("üé• –ó–∞–ø–∏—Å –≤—ñ–¥–µ–æ. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –û–ö, —â–æ–± –∑—É–ø–∏–Ω–∏—Ç–∏.");
  recorder.stop();
}
async function startCall(){
  if(!activeChat){ alert("–û–±–µ—Ä—ñ—Ç—å —á–∞—Ç"); return; }
  alert("WebRTC –¥–∑–≤—ñ–Ω–æ–∫: –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –æ–±–º—ñ–Ω SDP —á–µ—Ä–µ–∑ /api/webrtc/offer/answer (–¥–µ–º–æ).");
}

/* PIN & QR */
function openPinModal(){ document.getElementById("pinModal").style.display="flex"; }
function closePinModal(){ document.getElementById("pinModal").style.display="none"; }
function savePins(){
  const main = document.getElementById("mainPin").value;
  const fake = document.getElementById("fakePin").value;
  pins.main = main || null;
  pins.fake = fake || null;
  alert("PIN –∑–±–µ—Ä–µ–∂–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ (–¥–µ–º–æ).");
  closePinModal();
}
function openQrModal(){
  const modal = document.getElementById("qrModal");
  modal.style.display="flex";
  const canvas = document.getElementById("qrCanvas");
  const text = activeChat
    ? ("chat-key:"+currentUser.id+":"+activeChat.id)
    : ("chat-key:"+currentUser.id+":none");
  QRCode.toCanvas(canvas, text, {width:220}, err=>{ if(err) console.error(err); });
}
function closeQrModal(){ document.getElementById("qrModal").style.display="none"; }

/* EVENTS */
document.getElementById("searchInput").addEventListener("keyup", e=>{
  if(e.key==="Enter") searchUsers();
});

document.addEventListener("DOMContentLoaded", ()=>{
  initAuth().then(()=>{
    addSystem("SpySignal WebApp –≥–æ—Ç–æ–≤–∏–π. –ó–Ω–∞–π–¥–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —á–µ—Ä–µ–∑ –ø–æ—à—É–∫, —â–æ–± –ø–æ—á–∞—Ç–∏ —á–∞—Ç.");
  }).catch(e=>{
    console.error(e);
    addSystem("–ü–æ–º–∏–ª–∫–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó.");
  });
});
</script>
</body>
</html>
